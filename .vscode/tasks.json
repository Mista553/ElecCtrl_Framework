{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "configure task(Ninja)",       // 任务标签,可以改成mingw,这里使用的为Ninja编译
            "type": "shell",                        // 任务类型
            "command": "cmake",                     // 任务命令,线程数可以根据自己的电脑修改,建议与cpu核数相同
            "args": [
                "-S", "${workspaceFolder}",
                "-B", "${workspaceFolder}/build/Debug",
                "-G", "Ninja",
                "-DCMAKE_BUILD_TYPE=Debug",
                "-DCMAKE_TOOLCHAIN_FILE=${workspaceFolder}/cmake/gcc-arm-none-eabi.cmake"
            ],
            "problemMatcher": [],          
        },
        {
            "label": "build task(Ninja)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build", "${workspaceFolder}/build/Debug",
                "-j", "${env:NUMBER_OF_PROCESSORS}"
            ],
            "problemMatcher": "$gcc",
            "dependsOn": ["configure task(Ninja)"],
            "dependsOrder": "sequence"
        },
        {
            "label": "download dap",
            "type": "shell",               // 如果希望在下载前编译,可以把command换成下面的命令
            "command": "openocd",
            "args": [
                "-f", "${workspaceFolder}/openocd_dap.cfg",
                "-c", "init",
                "-c", "halt",
                "-c", "program {${workspaceFolder}/build/Debug/ElecCtrl_Framework.elf} verify",
                "-c", "reset",
                "-c", "shutdown"
            ],
            "options": {
                "cwd": "${workspaceFolder}",
                "env": {
                    "PATH": "${env:PATH};C:\\ProgramData\\chocolatey\\bin;C:\\Program Files\\OpenOCD\\bin"
                }
            },
            "group": {                     // 如果没有修改代码,编译任务不会消耗时间,因此推荐使用上面的替换.
                "kind": "build",
                "isDefault": false,
            },
            "dependsOn": ["build task(Ninja)"],
            "dependsOrder": "sequence"
        },
        // {
        //     "label": "download jlink", // 要使用此任务,需添加jlink的环境变量
        //     "type": "shell",
        //     "command":"mingw32-make -j24 ; mingw32-make download_jlink", // "mingw32-make -j24 ; mingw32-make download_jlink"
        //     "group": {
        //         "kind": "build",
        //         "isDefault": false,
        //     }
        // },
        // {
        //     "label": "log",
        //     "type": "shell",
        //     "command":"JlinkRTTClient",
        //     "args": [],
        //     "problemMatcher": [],
        //     // "dependsOn":[
        //     //     "build task", // 可以添加多个.
        //     // ]
        //     // 若使用daplink,则将log任务设置为依赖于jlink launch任务,保证jlink launch任务先于log任务执行
        // }
    ]
}